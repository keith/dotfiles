#!/usr/bin/env bash

set -euo pipefail

readonly sock="$HOME/.opener.sock"

if [[ -n "${SSH_CLIENT:-}" ]]; then
  if [[ -S "$sock" ]]; then
    if [[ -p /dev/stdin ]]; then
      cat - | nc -U "$sock"
    else
      echo "${@}" | nc -U "$sock"
    fi

    exit 0
  fi
fi

if [[ -x /usr/bin/xdg-open ]]; then
  /usr/bin/xdg-open "$@"
else
  /usr/bin/open "$@"
fi
